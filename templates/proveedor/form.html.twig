{% extends 'admin.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="/css/form.css">
{% endblock %}

{% block viewer_content %}
<div class="form-container">
    <h2>{{ titulo }}</h2>

    {# === FEEDBACK AL USUARIO === #}
    {% for tipo, mensajes in app.flashes %}
        {% if tipo in ['success', 'error', 'warning'] %}
            {% for mensaje in mensajes %}
                <div class="alert {{ tipo == 'success' ? 'alert-success' : 'alert-error' }}">
                    {{ mensaje }}
                </div>
            {% endfor %}
        {% endif %}
    {% endfor %}

    {# === ERRORES DE VALIDACIÓN === #}
    {% if errores is defined and errores|length > 0 %}
        <div class="alert alert-error">
            <ul>
                {% for error in errores %}
                    <li>{{ error }}</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    {# === FORMULARIO === #}
    <form method="post" >
        <!-- CIF -->
        <label for="cif">CIF*</label>
        <input type="text" id="cif" name="cif"
               value="{{ proveedor.cif ?? '' }}"
               maxlength="9"
               pattern="[A-Za-z0-9]{1,9}"
               title="El CIF debe tener máximo 9 caracteres alfanuméricos"
               required>

        <!-- Nombre -->
        <label for="nombre">Nombre*</label>
        <input type="text" id="nombre" name="nombre"
               value="{{ proveedor.nombre ?? '' }}"
               maxlength="255"
               required>

        <!-- Correo electrónico -->
        <label for="correo">Correo electrónico*</label>
        <input type="email" id="correo" name="correo"
               value="{{ proveedor.correoElectronico ?? '' }}"
               maxlength="255"
               required
               title="Introduce un correo válido (ejemplo: usuario@dominio.com)">
        {% if errors is defined and errors.correo is defined %}
            <p class="error-message">{{ errors.correo }}</p>
        {% endif %}

        <!-- Teléfono principal -->
        <label for="telefono">Teléfono*</label>
        <input type="text" id="telefono" name="telefono"
               value="{{ proveedor.telefono ?? '' }}"
               maxlength="20"
               required
               title="Introduce un número de teléfono válido">

        <!-- Teléfono 2 (opcional) -->
        <label for="telefono2">Teléfono 2</label>
        <input type="text" id="telefono2" name="telefono2"
               value="{{ proveedor.telefono2 ?? '' }}"
               maxlength="20">

        <!-- Tipo de proveedor -->
        <label for="tipo_proveedor">Tipo de proveedor*</label>
        <select id="tipo_proveedor" name="tipo_proveedor" required>
            <option value="">Selecciona un tipo</option>
            <option value="Hotel" {% if proveedor.tipoProveedor == 'Hotel' %}selected{% endif %}>Hotel</option>
            <option value="Crucero" {% if proveedor.tipoProveedor == 'Crucero' %}selected{% endif %}>Crucero</option>
            <option value="Estación de esquí" {% if proveedor.tipoProveedor == 'Estación de esquí' %}selected{% endif %}>Estación de esquí</option>
            <option value="Parque temático" {% if proveedor.tipoProveedor == 'Parque temático' %}selected{% endif %}>Parque temático</option>
        </select>

        <!-- Estado activo -->
        <div class="form-check">
            <input
                type="checkbox"
                id="activo"
                name="activo"
                class="form-check-input"
                {% if (proveedor is defined and proveedor.activo) or (accion is defined and accion == 'nuevo') %}
                    checked
                {% endif %}
            >
            <label class="form-check-label" for="activo">Activo</label>
        </div>

        <!-- Botones -->
        <div class="btn-container">
            <button type="submit">
                {% if accion == 'editar' %}
                    Guardar cambios
                {% else %}
                    Crear proveedor
                {% endif %}
            </button>
            <a href="{{ path('app_proveedores') }}" class="btn-cancel">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
